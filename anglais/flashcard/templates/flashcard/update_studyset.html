{% load bootstrap4 %}
{% load static %}

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> -->
    {% bootstrap_css %}
    {% bootstrap_javascript jquery='full' %}
    <link rel="stylesheet" href="{% static 'styles\func_1_styles.css' %}">
    <title>fucking kill me  </title>
  </head>

  <body>

    <!-- 
      Navbar
    -->
    <nav class="navbar navbar-expand-lg navbar-dark flex-md-row bd-navbar">

      <!-- 
        Homepage link
       -->
      <a class="navbar-brand align-items-center" href="{% url 'flashcard:home' %}" >
        <img src="{% static 'images\logo.png' %}" class="rounded img-fluid col-sm rounded mx-auto logo-image" alt="Responsive image" >
        Tốn Liền's super pretty web
      </a>

      
      <!-- 
        Responsive button for when the window size get small
       -->
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- 
        Other buttons to lead to other URLs
       -->
      <div class="collapse navbar-collapse align-content-center" id="navbarNav">
        <ul class="navbar-nav ">
          <!-- 
            Home button
           -->
          <li class="nav-item active ">
            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
          </li>
          <!-- 
            Feature button
           -->
          <li class="nav-item ">
            <a class="nav-link" href="#">Features</a>
          </li>
        </ul>

        <!-- 
          Log out button
         -->
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="#">Log out</a>
          </li>
        </ul>
      </div>
    </nav>
    
    <!-- Welcome text - Currently left blank -->
    <form  method = "post" id="wordform" >
        {% csrf_token %}
        <div class = "set_declarer">
          <div class = "set_container">
            <!-- Studyset form name  -->
            <div class = "set_name_container">
              {{ form.title }}
            </div>
    
            <!-- Studyset form description  -->
            <div class = "desc_name_container">
              {{ form.description }}
            </div>
          </div>
        </div>
    
        <div class="set_creator">
          {{ formset.management_form }}
          <div id="formset-container">
            {% for form in formset %}
              <div class="formset-form">
                {{ form.id }}
                {{ form.or_lan }} | {{ form.ori_word}} | {{ form.trans_word }} | {{ form.ne_lan }}
                
                
                <button type="button" class="delete-form-btn">Delete</button>
                

              </div>
            {% endfor %}
          </div>

        </div>
    
        
        
      <button class = "add_more" id = "add-form-btn"> Add more </button>
      <input type="submit" value="Submit">
    </form>


    <script id="empty-form-template" type="text/template">

      <div class="formset-form">
          {{ formset.empty_form.as_p | safe }}
          <button type="button"  class="delete-form-btn">Delete</button>
      </div>

  </script>


  
  <script>
      $(document).ready(function() {

          var totalForms = $('#id_{{ formset.prefix }}-TOTAL_FORMS');

          var formsetContainer = $('#formset-container'); 

          var emptyFormTemplate = $('#empty-form-template').text(); 

      

          // Hàm update lại index của form 
          function updateElementIdx(el, prefix, index) {
              var idRegex = new RegExp('(' + prefix + '-\\d+)'); 

              var replacement = prefix + '-' + index; 

              if ($(el).attr("for")) $(el).attr("for", $(el).attr("for").replace(idRegex, replacement)); 

              if (el.id) el.id = el.id.replace(idRegex, replacement); 

              if (el.name) el.name = el.name.replace(idRegex, replacement)

          }

          // Add form button 

          $('#add-form-btn').click(function() {

              var newForm = emptyFormTemplate.replace(/__prefix__/g, totalForms.val()); 
              formsetContainer.append(newForm); 

              totalForms.val(parseInt(totalForms.val()) + 1); 

          }); 

          // Delete form button 
          formsetContainer.on('click', '.delete-form-btn', function() {
              $(this).closest('.formset-form').remove();
              var forms = formsetContainer.find('.formset-form'); 

              $('#id_{{ formset.prefix }}-TOTAL_FORMS').val(forms.length); 

              for (var i = 0, formCount = form.length; i < formCount; i ++) {
                  updateElementIdx(forms.get(i), '{{ formset.prefix }}', i); 
              }


          });

      }); 

  </script>




    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="../../static/js/func_1.js"></script>


  </body>
</html>